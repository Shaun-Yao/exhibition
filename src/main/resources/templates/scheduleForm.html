<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>订货会智能会务系统</title>
    <script src="/webjars/jquery/3.1.1/jquery.min.js"></script>
    <script src="/webjars/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script src="/webjars/bootbox.js/5.1.3/dist/bootbox.min.js"></script>
    <script src="/webjars/bootstrap-fileinput/5.0.1/js/fileinput.min.js"></script>
    <script src="/webjars/bootstrap-fileinput/5.0.1/js/locales/zh.js"></script>
    <link rel="stylesheet" href="/webjars/bootstrap/3.3.7/css/bootstrap.min.css" />
    <link rel="stylesheet" href="/webjars/bootstrap-fileinput/5.0.1/css/fileinput.min.css" />
    <link rel="stylesheet" href="/webjars/weui/1.1.2/dist/style/weui.min.css" />

</head>
<body>
<div class="panel panel-primary">
    <div class="panel-heading">
        <h3 class="panel-title">填写行程信息</h3>
    </div>
    <div class="panel-body">
        <form role="form" id="form" th:action="@{add}" method="post" enctype="multipart/form-data" >

            <div class="panel panel-info">
                <div class="panel-heading">
                    <h3 class="panel-title">
                        来程信息
                    </h3>
                </div>
                <div class="panel-body">
                    <input type="hidden" name="id" th:value="${schedule == null ? '' : schedule.id}"/>
                    <input type="hidden" name="userId" th:value="${schedule == null ? session.user.id : schedule.userId}"/>

                    <div class="form-group">
                        <label for="arrivedTravelMode">出行方式</label>
                        <select name="arrivedTravelMode" id="arrivedTravelMode" class="form-control" required>
                            <option></option>
                            <option th:each="type : ${T(com.honji.exhibition.enums.TravelModeEnum).values()}"
                                    th:value="${type}" th:text="${type.desc}"
                                    th:selected="${schedule != null && type eq schedule.arrivedTravelMode}">
                            </option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="arrivedNum" class="control-label">航班/班次</label>
                        <input type="text" class="form-control" name="arrivedNum" id="arrivedNum" minlength="2" maxlength="6"
                               th:value="${schedule == null ? '' : schedule.arrivedNum}" required />
                    </div>

                    <div class="form-group">
                        <label for="arrivedTime" class="control-label">到达时间</label>
                        <input type="datetime-local" class="form-control" name="arrivedTime" id="arrivedTime" required="required"
                               th:min="${scheduleTimeConfig.arriveStartTime}" th:max="${scheduleTimeConfig.arriveEndTime}"
                               th:value="${schedule == null ? scheduleTimeConfig.arriveStartTime : schedule.arrivedTime}" />
                    </div>

                    <div class="form-group">
                        <label for="arrivedPickUpStation">接送站点</label>
                        <select class="form-control" name="arrivedPickUpStation" id="arrivedPickUpStation" required>
                            <option></option>
                            <option th:each="type : ${T(com.honji.exhibition.enums.StationEnum).values()}"
                                    th:value="${type}" th:text="${type.desc}"
                                    th:selected="${schedule != null && type eq schedule.arrivedPickUpStation}">
                            </option>
                        </select>
                    </div>
                </div>

            </div>


            <div class="panel panel-info">
                <div class="panel-heading">
                    <h3 class="panel-title">
                        返程信息
                    </h3>
                </div>
                <div class="panel-body">

                    <div class="form-group">
                        <label for="arrivedTravelMode">出行方式</label>
                        <select name="leavedTravelMode" id="leavedTravelMode" class="form-control" required>
                            <option></option>
                            <option th:each="type : ${T(com.honji.exhibition.enums.TravelModeEnum).values()}"
                                    th:value="${type}" th:text="${type.desc}"
                                    th:selected="${schedule != null && type eq schedule.leavedTravelMode}">
                            </option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="leavedNum" class="control-label">航班/班次</label>
                        <input type="text" class="form-control" name="leavedNum" id="leavedNum" minlength="2" maxlength="6"
                               th:value="${schedule == null ? '' : schedule.leavedNum}" required/>
                    </div>

                    <div class="form-group">
                        <label for="leavedTime" class="control-label">返程时间</label>
                        <input type="datetime-local" class="form-control" name="leavedTime" id="leavedTime" required="required"
                               th:min="${scheduleTimeConfig.arriveStartTime}" th:max="${scheduleTimeConfig.arriveEndTime}"
                               th:value="${schedule == null ? scheduleTimeConfig.arriveStartTime : schedule.leavedTime}" />
                    </div>

                    <div class="form-group">
                        <label for="leavedPickUpLocation">返程出发地</label>
                        <select class="form-control" name="leavedPickUpLocation" id="leavedPickUpLocation" required>
                            <option></option>
                            <option th:each="type : ${T(com.honji.exhibition.enums.LeavePickUpLocationEnum).values()}"
                                    th:value="${type}" th:text="${type.desc}"
                                    th:selected="${schedule != null && type eq schedule.leavedPickUpLocation}">
                            </option>
                        </select>
                    </div>


                    <div class="form-group">
                        <label for="leavedStation">返程站点</label>
                        <select class="form-control" name="leavedStation" id="leavedStation" required>
                            <option></option>
                            <option th:each="type : ${T(com.honji.exhibition.enums.LeaveStationEnum).values()}"
                                    th:value="${type}" th:text="${type.desc}"
                                    th:selected="${schedule != null && type eq schedule.leavedStation}">
                            </option>
                        </select>
                    </div>
                </div>
            </div>

            <!--<input id="input-id" type="file" name="file" data-preview-file-type="text" data-msg-placeholder="上传来程班次图片" >
-->


<!--

            <div class="weui-uploader">
                <div class="weui-uploader__hd">
                    <p class="weui-uploader__title">上传现场照片</p>
                    <div class="weui-uploader__info" id="uploader_count" data-total="3" data-val="0">0/3</div>
                </div>
                <div class="weui-uploader__bd">
                    <ul class="weui-uploader__files" id="uploader_files"></ul>
                    <div class="weui-uploader__input-box">
                        <input class="weui-uploader__input" id="uploader_input" type="file" accept="image/*" multiple="">
                    </div>
                </div>
            </div>
-->

            <div class="col-md-4 text-center">
                <button type="button" class="btn btn-primary btn-lg" id="submitBtn">保存</button>
                <button type="button" onclick="goBack()" class="btn btn-info btn-lg">取消</button>
            </div>

        </form>
    </div>

    <!--BEGIN toast-->
    <div id="toast" style="display: none;">
        <div class="weui-mask_transparent"></div>
        <div class="weui-toast">
            <i class="weui-icon-success-no-circle weui-icon_toast"></i>
            <p class="weui-toast__content">最多只能上传2张图片</p>
        </div>
    </div>
    <!--end toast-->

</div>
</body>
<script>

    function goBack() {
        $(".panel-body").modal('show');
        window.location.href='/user/toApply';
    }


    $(function(){

        $('#arrivedTravelMode').change(function () {
            switch (this.value) {
                case 'PLANE':
                    $('#arrivedPickUpStation option[value=AIRPORT]')[0].selected=true;
                    break;
                case 'HIGH_SPEED_RAIL':
                    $('#arrivedPickUpStation option[value=HIGH_SPEED_RAIL_STATION]')[0].selected=true;
                    break;
                case 'TRAIN':
                    $('#arrivedPickUpStation option[value=TRAIN_STATION]')[0].selected=true;
                    break;
                default:
                    $('#arrivedNum').val('无');
                    $('#arrivedPickUpStation option[value=NONE]')[0].selected=true;
            }
        });

        $('#leavedTravelMode').change(function () {
            switch (this.value) {
                case 'PLANE':
                    $('#leavedStation option[value=AIRPORT]')[0].selected=true;
                    break;
                case 'HIGH_SPEED_RAIL':
                    $('#leavedStation option[value=HIGH_SPEED_RAIL_STATION]')[0].selected=true;
                    break;
                case 'TRAIN':
                    $('#leavedStation option[value=TRAIN_STATION]')[0].selected=true;
                    break;
                default:
                    $('#leavedNum').val('无');
                    $('#leavedPickUpLocation option[value=NONE]')[0].selected=true;
                    $('#leavedStation option[value=NONE]')[0].selected=true;
            }
        });

/*

        $("#input-id").fileinput({
            language : 'zh',
            showUpload: false,
            dropZoneEnabled: false,
            maxFileSize: 1000,
            allowedFileExtensions: ["jpg", "png"]
        });
*/


        $('#submitBtn').click(function() {
            if($('#form')[0].reportValidity()) {
                //var arrivedTravelMode = $('#arrivedTravelMode').val();
                //if ()
                $(".panel-body").modal('show');
                $('#form').submit();
            }
        });

    });

</script>
</html>